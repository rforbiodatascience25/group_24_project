"0","pca_fit <- bm_data |>"
"0","  select(where(is.numeric)) |>"
"0","  drop_na() |>"
"0","  prcomp(scale = TRUE)"
"0",""
"0","r_matrix <- pca_fit |>"
"0","  tidy(matrix = ""rotation"")|>"
"0","  pivot_wider(names_from = ""PC"", names_prefix = ""PC"", values_from = ""value"")"
"0",""
"0","pca_plot <- pca_fit |>"
"0","  augment(bm_data) |>"
"0","  ggplot(aes(x = .fittedPC1, "
"0","             y = .fittedPC2, "
"0","             colour = survival_status)) +"
"0","  geom_point(size = 1.5) +"
"0","  labs(x = ""PC1 (31,2%)"","
"0","       y = ""PC2 (15,5%)"", "
"0","       colour = ""Survival Status"") +"
"0","  scale_colour_viridis_d() +"
"0","  theme_minimal() +"
"0","  theme(legend.position = ""bottom"") "
"0","  "
"0",""
"0","# define arrow style for plotting"
"0","arrow_style <- arrow("
"0","  angle = 20, ends = ""first"", type = ""closed"", length = grid::unit(8, ""pt"")"
"0",")"
"0",""
"0","# plot rotation matrix"
"0","rotation_plot <- pca_fit |>"
"0","  tidy(matrix = ""rotation"")|>"
"0","  pivot_wider(names_from = ""PC"", "
"0","              names_prefix = ""PC"", "
"0","              values_from = ""value"")|>"
"0","  ggplot(mapping = aes(PC1, PC2)) +"
"0","  geom_segment(xend = 0, yend = 0, arrow = arrow_style) +"
"0","  geom_text_repel(aes(label = column),"
"0","                  size = 3,"
"0","                  colour = ""blue"","
"0","                  hjust = 1,"
"0","                  nudge_x = 0.2) +"
"0","  scale_x_continuous(limits = c(-0.8,1.0)) +"
"0","  scale_y_continuous(limits = c(-0.8,1.0)) +"
"0","  theme_minimal() "
"0",""
"0","(pca_plot|rotation_plot) +"
"0","  plot_annotation(title = 'PCA analysis') +"
"0","  plot_annotation(tag_levels = 'I')"
