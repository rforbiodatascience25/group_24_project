"0","HLA_data <- bm_data |>"
"0","  select(HLAmatch, HLAmatch, HLAmismatch, Antigen, Alel, HLAgrI, survival_time, survival_status) |> "
"0","  mutate(HLAmatch = fct_relevel(HLAmatch, c(""7/10"", ""8/10"", ""9/10"", ""10/10"")))"
"0",""
"0","HLA_data |>"
"0","  count(HLAmatch, survival_status) |>"
"0","  group_by(HLAmatch) |>"
"0","  mutate(survival_pct = str_c(round(n / sum(n) *100, 1), ""%"")) |> "
"0","  ggplot(aes(x = HLAmatch, "
"0","             y = survival_pct, "
"0","             fill = survival_status, "
"0","             label = survival_pct)) +"
"0","  geom_col(position = ""dodge"", "
"0","           alpha = 0.5) +"
"0","  geom_text(position = position_dodge(0.9)) +"
"0","  theme_minimal() +"
"0","  scale_fill_viridis_d() +"
"0","  labs(x = ""HLA Match"", "
"0","       y = ""Percentage (%)"","
"0","       fill = ""Survival Status"", "
"0","       title = ""Survival Status of Patients"""
"0","       ) +"
"0","  theme(legend.position = ""bottom"") "
"0",""
