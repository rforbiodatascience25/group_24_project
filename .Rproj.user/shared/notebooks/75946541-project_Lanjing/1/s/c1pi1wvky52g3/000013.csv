"0","library(dplyr)"
"0","library(ggplot2)"
"0",""
"0","data_clean_aug |>"
"0","  mutate("
"0","    Rbodymass = case_when("
"0","      Rbodymass < 18.5 ~ ""Underweight"","
"0","      Rbodymass >= 18.5 & Rbodymass < 25 ~ ""Normal weight"","
"0","      Rbodymass >= 25 & Rbodymass < 30 ~ ""Overweight"","
"0","      Rbodymass >= 30 ~ ""Obese"""
"0","    ),"
"0","    Rbodymass = fct_relevel(Rbodymass,"
"0","                                  'Underweight',"
"0","                                  'Normal weight',"
"0","                                  'Overweight',"
"0","                                  'Obese')"
"0","  ) |>"
"0","  filter(!is.na(Rbodymass)) |>                      "
"0","  count(survival_status, Rbodymass) |>"
"0","  group_by(Rbodymass) |>"
"0","  "
"0","  mutate(Rbodymass_percentage = str_c(round(n / sum(n) * 100, 1), ""%"")) |>"
"0","  "
"0","  ggplot(aes(x = factor(Rbodymass),"
"0","             y = n,"
"0","             fill = factor(survival_status))) +"
"0","  "
"0","  geom_col(position = 'dodge',"
"0","           alpha = 0.5) + "
"0","  "
"0","  geom_text(aes(label = Rbodymass_percentage),"
"0","             position = position_dodge(1),"
"0","            vjust = -0.5,"
"0","            size = 3)+"
"0","  "
"0","  theme_minimal()+"
"0","  scale_fill_viridis_d() +"
"0","  labs("
"0","    title = 'Rbodymass VS Survival rate',"
"0","    x = 'Survival Status', "
"0","    y = 'Number of recipients',"
"0","    fill = 'Survival Status'"
"0","  )+"
"0","  theme(legend.position = ""bottom"") "
